import{u as oe,g as de,a as fe,c as q,e as k,B as ce,q as he,h as me,i as pe}from"./shared-083249af.js";import{d as G,a as p,b as we,w as Te,o as Ie,u as Se,Z as $,f as S,h as g,M as ge,O as V,N as E,R as F,F as Ee,ai as be,j as ye,X as Pe}from"./vue-router.esm-bundler-a6d65396.js";var H=Symbol("SWIPE_BIND_SWIPE_ITEM_KEY"),Z=Symbol("SWIPE_COUNT_SWIPE_ITEM_KEY");function Ce(){var{childProviders:e,bindChildren:u}=de(H),{length:n}=oe(Z);return{length:n,swipeItems:e,bindSwipeItems:u}}var ke={loop:{type:Boolean,default:!0},autoplay:{type:[String,Number]},duration:{type:[String,Number],default:300},initialIndex:{type:[String,Number],default:0},indicator:{type:Boolean,default:!0},indicatorColor:{type:String},vertical:{type:Boolean,default:!1},touchable:{type:Boolean,default:!0},onChange:fe()};function U(e,u,n,f,s,v,d){try{var t=e[v](d),c=t.value}catch(N){n(N);return}t.done?u(c):Promise.resolve(c).then(f,s)}function Ne(e){return function(){var u=this,n=arguments;return new Promise(function(f,s){var v=e.apply(u,n);function d(c){U(v,f,s,d,t,"next",c)}function t(c){U(v,f,s,d,t,"throw",c)}d(void 0)})}}var ze=250,Me=20,{n:Ye,classes:Be}=q("swipe"),We=["onClick"];function De(e,u){return S(),g("div",{class:E(e.n()),ref:"swipeEl"},[ge("div",{class:E(e.classes(e.n("track"),[e.vertical,e.n("--vertical")])),style:F({width:e.vertical?void 0:e.trackSize+"px",height:e.vertical?e.trackSize+"px":void 0,transform:"translate"+(e.vertical?"Y":"X")+"("+e.translate+"px)",transitionDuration:e.lockDuration?"0ms":e.toNumber(e.duration)+"ms"}),onTouchstart:u[0]||(u[0]=function(){return e.handleTouchstart&&e.handleTouchstart(...arguments)}),onTouchmove:u[1]||(u[1]=function(){return e.handleTouchmove&&e.handleTouchmove(...arguments)}),onTouchend:u[2]||(u[2]=function(){return e.handleTouchend&&e.handleTouchend(...arguments)})},[V(e.$slots,"default")],38),V(e.$slots,"indicator",{index:e.index,length:e.length},()=>[e.indicator&&e.length?(S(),g("div",{key:0,class:E(e.classes(e.n("indicators"),[e.vertical,e.n("--indicators-vertical")]))},[(S(!0),g(Ee,null,be(e.length,(n,f)=>(S(),g("div",{class:E(e.classes(e.n("indicator"),[e.index===f,e.n("--indicator-active")],[e.vertical,e.n("--indicator-vertical")])),style:F({background:e.indicatorColor}),key:n,onClick:s=>e.to(f)},null,14,We))),128))],2)):ye("v-if",!0)])],2)}var j=G({name:"VarSwipe",props:ke,setup(e){var u=p(null),n=p(0),f=we(()=>e.vertical),s=p(0),v=p(0),d=p(!1),t=p(0),{swipeItems:c,bindSwipeItems:N,length:l}=Ce(),b=!1,z=-1,y,P,O,w,T,h=a=>c.find(r=>{var{index:i}=r;return i.value===a}),Q=()=>{e.loop&&(v.value>=0&&h(l.value-1).setTranslate(-s.value),v.value<=-(s.value-n.value)&&h(0).setTranslate(s.value),v.value>-(s.value-n.value)&&v.value<0&&(h(l.value-1).setTranslate(0),h(0).setTranslate(0)))},M=a=>{var r=Pe(a)?a:Math.floor((v.value-n.value/2)/-n.value),{loop:i}=e;return r<=-1?i?-1:0:r>=l.value?i?l.value:l.value-1:r},_=a=>{var{loop:r}=e;return a===-1?r?l.value-1:0:a===l.value?r?0:l.value-1:a},Y=a=>{var{loop:r}=e;return a<0?r?l.value-1:0:a>l.value-1?r?0:l.value-1:a},B=a=>{var r=v.value>=n.value,i=v.value<=-s.value,o=0,m=-(s.value-n.value);d.value=!0,(r||i)&&(d.value=!0,v.value=i?o:m,h(0).setTranslate(0),h(l.value-1).setTranslate(0)),ce(()=>{d.value=!1,k(a)})},x=()=>{t.value=Y($(e.initialIndex))},W=()=>{var{autoplay:a}=e;!a||l.value<=1||(D(),z=window.setTimeout(()=>{X(),W()},$(a)))},D=()=>{z&&clearTimeout(z)},ee=(a,r)=>{if(a>r&&a>10)return"horizontal";if(r>a&&r>10)return"vertical"},ae=a=>{if(!(l.value<=1||!e.touchable)){var{clientX:r,clientY:i}=a.touches[0];y=r,P=i,O=performance.now(),b=!0,D(),B(()=>{d.value=!0})}},re=a=>{var{touchable:r,vertical:i}=e;if(!(!b||!r)){var{clientX:o,clientY:m}=a.touches[0],I=Math.abs(o-y),A=Math.abs(m-P),ue=ee(I,A),ve=i?"vertical":"horizontal";if(ue===ve){a.preventDefault();var ie=w!==void 0?o-w:0,se=T!==void 0?m-T:0;w=o,T=m,v.value+=i?se:ie,Q()}}},ne=()=>{if(b){var{vertical:a,onChange:r}=e,i=a?T<P:w<y,o=Math.abs(a?P-T:y-w),m=performance.now()-O<=ze&&o>=Me,I=m?M(i?t.value+1:t.value-1):M();b=!1,d.value=!1,w=void 0,T=void 0,v.value=I*-n.value;var A=t.value;t.value=_(I),W(),A!==t.value&&k(r,t.value)}},C=()=>{u.value&&(d.value=!0,n.value=e.vertical?u.value.offsetHeight:u.value.offsetWidth,s.value=n.value*l.value,v.value=t.value*-n.value,c.forEach(a=>{a.setTranslate(0)}),W(),setTimeout(()=>{d.value=!1}))},X=a=>{if(!(l.value<=1)){var{loop:r,onChange:i}=e,o=t.value;t.value=Y(o+1),(a==null?void 0:a.event)!==!1&&k(i,t.value),B(()=>{if(o===l.value-1&&r){h(0).setTranslate(s.value),v.value=l.value*-n.value;return}o!==l.value-1&&(v.value=t.value*-n.value)})}},R=a=>{if(!(l.value<=1)){var{loop:r,onChange:i}=e,o=t.value;t.value=Y(o-1),(a==null?void 0:a.event)!==!1&&k(i,t.value),B(()=>{if(o===0&&r){h(l.value-1).setTranslate(-s.value),v.value=n.value;return}o!==0&&(v.value=t.value*-n.value)})}},te=(a,r)=>{if(!(l.value<=1||a===t.value)){a=a<0?0:a,a=a>=l.value?l.value:a;var i=a>t.value?X:R,o=Math.abs(a-t.value);Array.from({length:o}).forEach((m,I)=>{i({event:I===o-1?r==null?void 0:r.event:!1})})}},le={size:n,vertical:f};return N(le),Te(()=>l.value,Ne(function*(){yield he(),x(),C()})),Ie(()=>{window.addEventListener("resize",C)}),Se(()=>{window.removeEventListener("resize",C),D()}),{n:Ye,classes:Be,length:l,index:t,swipeEl:u,trackSize:s,translate:v,lockDuration:d,handleTouchstart:ae,handleTouchmove:re,handleTouchend:ne,next:X,prev:R,to:te,resize:C,toNumber:$}}});j.render=De;const L=j;L.install=function(e){e.component(L.name,L)};function Xe(){var{bindParent:e,parentProvider:u}=me(H),{index:n}=pe(Z);if(!e||!u||!n)throw Error("<var-swipe-item/> must in <var-swipe/>");return{index:n,swipe:u,bindSwipe:e}}var{n:Ae}=q("swipe-item");function $e(e,u){return S(),g("div",{class:E(e.n()),style:F({width:e.vertical?void 0:e.size+"px",height:e.vertical?e.size+"px":void 0,transform:"translate"+(e.vertical?"Y":"X")+"("+e.translate+"px)"})},[V(e.$slots,"default")],6)}var J=G({name:"VarSwipeItem",setup(){var e=p(0),{swipe:u,bindSwipe:n,index:f}=Xe(),{size:s,vertical:v}=u,d=c=>{e.value=c},t={index:f,setTranslate:d};return n(t),{n:Ae,size:s,vertical:v,translate:e}}});J.render=$e;const K=J;K.install=function(e){e.component(K.name,K)};export{L as S,K as a,ke as p};
