import{d as ve,a as D,r as de,b as y,w as G,o as me,p as fe,f as U,h as B,M as m,N as v,R as F,F as ce,ak as be,aj as J,O as he,Q as ge,q as Ve,n as Se}from"./vue-router.esm-bundler.61b845b6.js";import{u as ye,j as u,w as d,g as W,b as k,v as Fe,c as ke,N as Ne}from"./shared.cb7db5ff.js";import{F as Te,u as Ce}from"./provide.13fc0d2c.js";function we(e){return["always","normal","never"].includes(e)}var ze={modelValue:{type:[Number,Array],default:0},step:{type:[Number,String],default:1},range:{type:Boolean,default:!1},labelVisible:{type:String,default:"normal",validator:we},activeColor:{type:String},trackColor:{type:String},thumbColor:{type:String},labelColor:{type:String},labelTextColor:{type:String},trackHeight:{type:[String,Number]},max:{type:[String,Number],default:100},min:{type:[String,Number],default:0},thumbSize:{type:[String,Number]},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},rules:{type:Array},onChange:{type:Function},onStart:{type:Function},onEnd:{type:Function},"onUpdate:modelValue":{type:Function}},{n:K,classes:pe}=ke("slider"),t;(function(e){e.First="1",e.Second="2"})(t||(t={}));var Pe=["onTouchstart","onTouchmove","onTouchend","onTouchcancel"];function Le(e,C){var g=fe("var-form-details");return U(),B("div",{class:v(e.n())},[m("div",{class:v(e.classes(e.n("block"),[e.isDisabled,e.n("--disabled")],[e.errorMessage,e.n("--error")])),ref:"sliderEl",onClick:C[0]||(C[0]=function(){return e.click&&e.click(...arguments)})},[m("div",{class:v(e.n("track"))},[m("div",{class:v(e.n("track-background")),style:F({background:e.trackColor,height:e.multiplySizeUnit(e.trackHeight)})},null,6),m("div",{class:v(e.n("track-fill")),style:F(e.getFillStyle)},null,6)],2),(U(!0),B(ce,null,be(e.thumbList,i=>(U(),B("div",{class:v(e.n("thumb")),key:i.enumValue,style:F({left:i.value+"%",zIndex:e.thumbsProps[i.enumValue].active?1:void 0}),onTouchstart:J(f=>e.start(f,i.enumValue),["stop"]),onTouchmove:J(f=>e.move(f,i.enumValue),["stop"]),onTouchend:f=>e.end(i.enumValue),onTouchcancel:f=>e.end(i.enumValue)},[he(e.$slots,"button",{currentValue:i.text},()=>[m("div",{class:v(e.n("thumb-block")),style:F({background:e.thumbColor})},null,6),m("div",{class:v(e.classes(e.n("thumb-ripple"),[e.thumbsProps[i.enumValue].active,e.n("thumb-ripple--active")])),style:F({background:e.thumbColor})},null,6),m("div",{class:v(e.classes(e.n("thumb-label"),[e.showLabel(i.enumValue),e.n("thumb-label--active")])),style:F({background:e.labelColor,color:e.labelTextColor,height:e.thumbSize===void 0?e.thumbSize:e.multiplySizeUnit(e.thumbSize,2),width:e.thumbSize===void 0?e.thumbSize:e.multiplySizeUnit(e.thumbSize,2)})},[m("span",null,ge(i.text),1)],6)])],46,Pe))),128))],2),Ve(g,{"error-message":e.errorMessage,class:v(e.n("form")),"var-slider-cover":""},null,8,["error-message","class"])],2)}const E=ve({render:Le,name:"VarSlider",components:{VarFormDetails:Te},props:ze,setup(e){var{bindForm:C,form:g}=Ce(),{errorMessage:i,validateWithTrigger:f,validate:Y,resetValidation:A}=ye(),Z=()=>Y(e.rules,e.modelValue),I=()=>({startPosition:0,currentLeft:0,active:!1,percentValue:0}),x=()=>Se(()=>f(["onChange"],"onChange",e.rules,e.modelValue)),L=D(null),c=D(0),w=D(!1),n=de({[t.First]:I(),[t.Second]:I()}),M=y(()=>u(e.max)-u(e.min)),b=y(()=>c.value/M.value*u(e.step)),_=y(()=>{var{modelValue:a,range:r}=e,l=[];return r&&d(a)?l=[{value:V(a[0]),enumValue:t.First,text:T(a[0])},{value:V(a[1]),enumValue:t.Second,text:T(a[1])}]:W(a)&&(l=[{value:V(a),enumValue:t.First,text:T(a)}]),l}),ee=y(()=>{var{activeColor:a,range:r,modelValue:l}=e,s=r&&d(l)?V(Math.min(l[0],l[1])):0,o=r&&d(l)?V(Math.max(l[0],l[1]))-s:V(l);return{width:o+"%",left:s+"%",background:a}}),N=y(()=>e.disabled||(g==null?void 0:g.disabled.value)),z=y(()=>e.readonly||(g==null?void 0:g.readonly.value)),ae=a=>e.labelVisible==="always"?!0:e.labelVisible==="never"?!1:n[a].active,V=a=>{var{min:r,max:l}=e;return a<u(r)?0:a>u(l)?100:(a-u(r))/M.value*100},T=a=>{if(!W(a))return 0;var r=a;r<Number(e.min)&&(r=Number(e.min)),r>Number(e.max)&&(r=Number(e.max));var l=parseInt(""+r,10)===r;return l?r:u(r.toPrecision(5))},X=(a,r)=>{var l=[],{step:s,range:o,modelValue:h,onChange:p,min:S}=e,q=u(s),O=Math.round(a/b.value),P=O*q+u(S),se=n[r].percentValue*q+u(S);if(n[r].percentValue=O,o&&d(h)&&(l=r===t.First?[P,h[1]]:[h[0],P]),se!==P){var Q=o?l.map(oe=>T(oe)):T(P);k(p,Q),k(e["onUpdate:modelValue"],Q),x()}},re=a=>{if(!e.range)return t.First;var r=n[t.First].percentValue*b.value,l=n[t.Second].percentValue*b.value,s=Math.abs(a-r),o=Math.abs(a-l);return s<=o?t.First:t.Second},le=(a,r)=>{c.value||(c.value=L.value.offsetWidth),!(N.value||z.value)&&(k(e.onStart),w.value=!0,n[r].startPosition=a.touches[0].clientX)},te=(a,r)=>{if(!(N.value||z.value||!w.value)){var l=a.touches[0].clientX-n[r].startPosition+n[r].currentLeft;n[r].active=!0,l<=0?l=0:l>=c.value&&(l=c.value),X(l,r)}},$=a=>{var{range:r,modelValue:l,onEnd:s,step:o,min:h}=e;if(!(N.value||z.value)){var p=[];n[a].currentLeft=n[a].percentValue*b.value,n[a].active=!1;var S=n[a].percentValue*u(o)+u(h);r&&d(l)&&(p=a===t.First?[S,l[1]]:[l[0],S]),k(s,r?p:S),w.value=!1}},ne=a=>{if(!(N.value||z.value)&&!a.target.closest("."+K("thumb"))){var r=a.clientX-Ne(a.currentTarget),l=re(r);X(r,l),$(l)}},j=()=>{var a=u(e.step);return isNaN(a)?(console.warn('[Varlet] Slider: type of prop "step" should be Number'),!1):a<0?(console.warn('[Varlet] Slider: "step" should be > 0'),!1):!0},H=()=>{var{range:a,modelValue:r}=e;return a&&!d(r)?(console.error('[Varlet] Slider: "modelValue" should be an Array'),!1):!a&&d(r)?(console.error('[Varlet] Slider: "modelValue" should be a Number'),!1):a&&d(r)&&r.length<2?(console.error('[Varlet] Slider: "modelValue" should have two value'),!1):!0},R=function(a,r){a===void 0&&(a=e.modelValue),r===void 0&&(r=u(e.step));var l=s=>{var{min:o,max:h}=e;return s<u(o)?0:s>u(h)?M.value/r:(s-u(o))/r};e.range&&d(a)?(n[t.First].percentValue=l(a[0]),n[t.First].currentLeft=n[t.First].percentValue*b.value,n[t.Second].percentValue=l(a[1]),n[t.Second].currentLeft=n[t.Second].percentValue*b.value):W(a)&&(n[t.First].currentLeft=l(a)*b.value)},ue=()=>{var a=e.range?[0,0]:0;k(e["onUpdate:modelValue"],a),A()},ie={reset:ue,validate:Z,resetValidation:A};return k(C,ie),G([()=>e.modelValue,()=>e.step],a=>{var[r,l]=a;!j()||!H()||w.value||R(r,u(l))}),G(c,()=>R()),me(()=>{!j()||!H()||(c.value=L.value.offsetWidth)}),{n:K,classes:pe,Thumbs:t,sliderEl:L,getFillStyle:ee,isDisabled:N,errorMessage:i,thumbsProps:n,thumbList:_,multiplySizeUnit:Fe,toNumber:u,showLabel:ae,start:le,move:te,end:$,click:ne}}});E.install=function(e){e.component(E.name,E)};export{E as S};
