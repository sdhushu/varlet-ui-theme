import{H as ve,v as se,a as oe,l as L,c as G,e as k,j as de,M as fe,z as ce,s as he,I as me}from"./shared.b468a763.js";import{d as H,a as p,b as pe,w as we,o as Te,u as Ie,f as I,h as S,M as Se,O as V,N as g,R as F,F as ge,ak as Ee,j as be}from"./vue-router.esm-bundler.dfdc86af.js";var j=Symbol("SWIPE_BIND_SWIPE_ITEM_KEY"),q=Symbol("SWIPE_COUNT_SWIPE_ITEM_KEY");function ye(){var{childProviders:e,bindChildren:i}=se(j),{length:n}=ve(q);return{length:n,swipeItems:e,bindSwipeItems:i}}var Pe={loop:{type:Boolean,default:!0},autoplay:{type:[String,Number]},duration:{type:[String,Number],default:300},initialIndex:{type:[String,Number],default:0},indicator:{type:Boolean,default:!0},indicatorColor:{type:String},vertical:{type:Boolean,default:!1},touchable:{type:Boolean,default:!0},onChange:oe()};function U(e,i,n,d,s,u,o){try{var t=e[u](o),f=t.value}catch(z){n(z);return}t.done?i(f):Promise.resolve(f).then(d,s)}function Ce(e){return function(){var i=this,n=arguments;return new Promise(function(d,s){var u=e.apply(i,n);function o(f){U(u,d,s,o,t,"next",f)}function t(f){U(u,d,s,o,t,"throw",f)}o(void 0)})}}var ke=250,ze=20,{n:Ne,classes:Me}=G("swipe"),Ye=["onClick"];function We(e,i){return I(),S("div",{class:g(e.n()),ref:"swipeEl"},[Se("div",{class:g(e.classes(e.n("track"),[e.vertical,e.n("--vertical")])),style:F({width:e.vertical?void 0:e.trackSize+"px",height:e.vertical?e.trackSize+"px":void 0,transform:"translate"+(e.vertical?"Y":"X")+"("+e.translate+"px)",transitionDuration:e.lockDuration?"0ms":e.toNumber(e.duration)+"ms"}),onTouchstart:i[0]||(i[0]=function(){return e.handleTouchstart&&e.handleTouchstart(...arguments)}),onTouchmove:i[1]||(i[1]=function(){return e.handleTouchmove&&e.handleTouchmove(...arguments)}),onTouchend:i[2]||(i[2]=function(){return e.handleTouchend&&e.handleTouchend(...arguments)})},[V(e.$slots,"default")],38),V(e.$slots,"indicator",{index:e.index,length:e.length},()=>[e.indicator&&e.length?(I(),S("div",{key:0,class:g(e.classes(e.n("indicators"),[e.vertical,e.n("--indicators-vertical")]))},[(I(!0),S(ge,null,Ee(e.length,(n,d)=>(I(),S("div",{class:g(e.classes(e.n("indicator"),[e.index===d,e.n("--indicator-active")],[e.vertical,e.n("--indicator-vertical")])),style:F({background:e.indicatorColor}),key:n,onClick:s=>e.to(d)},null,14,Ye))),128))],2)):be("v-if",!0)])],2)}const $=H({render:We,name:"VarSwipe",props:Pe,setup(e){var i=p(null),n=p(0),d=pe(()=>e.vertical),s=p(0),u=p(0),o=p(!1),t=p(0),{swipeItems:f,bindSwipeItems:z,length:l}=ye(),E=!1,N=-1,b,y,O,w,T,c=a=>f.find(r=>{var{index:v}=r;return v.value===a}),J=()=>{!e.loop||(u.value>=0&&c(l.value-1).setTranslate(-s.value),u.value<=-(s.value-n.value)&&c(0).setTranslate(s.value),u.value>-(s.value-n.value)&&u.value<0&&(c(l.value-1).setTranslate(0),c(0).setTranslate(0)))},M=a=>{var r=de(a)?a:Math.floor((u.value-n.value/2)/-n.value),{loop:v}=e;return r<=-1?v?-1:0:r>=l.value?v?l.value:l.value-1:r},Q=a=>{var{loop:r}=e;return a===-1?r?l.value-1:0:a===l.value?r?0:l.value-1:a},Y=a=>{var{loop:r}=e;return a<0?r?l.value-1:0:a>l.value-1?r?0:l.value-1:a},W=a=>{var r=u.value>=n.value,v=u.value<=-s.value,h=0,m=-(s.value-n.value);o.value=!0,(r||v)&&(o.value=!0,u.value=v?h:m,c(0).setTranslate(0),c(l.value-1).setTranslate(0)),fe(()=>{o.value=!1,k(a)})},Z=()=>{t.value=Y(L(e.initialIndex))},B=()=>{var{autoplay:a}=e;!a||l.value<=1||(D(),N=window.setTimeout(()=>{A(),B()},L(a)))},D=()=>{N&&clearTimeout(N)},_=(a,r)=>{if(a>r&&a>10)return"horizontal";if(r>a&&r>10)return"vertical"},x=a=>{if(!(l.value<=1||!e.touchable)){var{clientX:r,clientY:v}=a.touches[0];b=r,y=v,O=performance.now(),E=!0,D(),W(()=>{o.value=!0})}},ee=a=>{var{touchable:r,vertical:v}=e;if(!(!E||!r)){var{clientX:h,clientY:m}=a.touches[0],C=Math.abs(h-b),X=Math.abs(m-y),te=_(C,X),le=v?"vertical":"horizontal";if(te===le){a.preventDefault();var ue=w!==void 0?h-w:0,ie=T!==void 0?m-T:0;w=h,T=m,u.value+=v?ie:ue,J()}}},ae=()=>{if(!!E){var{vertical:a,onChange:r}=e,v=a?T<y:w<b,h=Math.abs(a?y-T:b-w),m=performance.now()-O<=ke&&h>=ze,C=m?M(v?t.value+1:t.value-1):M();E=!1,o.value=!1,w=void 0,T=void 0,u.value=C*-n.value;var X=t.value;t.value=Q(C),B(),X!==t.value&&k(r,t.value)}},P=()=>{o.value=!0,n.value=e.vertical?i.value.offsetHeight:i.value.offsetWidth,s.value=n.value*l.value,u.value=t.value*-n.value,f.forEach(a=>{a.setTranslate(0)}),B(),setTimeout(()=>{o.value=!1})},A=()=>{if(!(l.value<=1)){var{loop:a,onChange:r}=e,v=t.value;t.value=Y(v+1),k(r,t.value),W(()=>{if(v===l.value-1&&a){c(0).setTranslate(s.value),u.value=l.value*-n.value;return}v!==l.value-1&&(u.value=t.value*-n.value)})}},R=()=>{if(!(l.value<=1)){var{loop:a,onChange:r}=e,v=t.value;t.value=Y(v-1),k(r,t.value),W(()=>{if(v===0&&a){c(l.value-1).setTranslate(-s.value),u.value=n.value;return}v!==0&&(u.value=t.value*-n.value)})}},re=a=>{if(!(l.value<=1||a===t.value)){a=a<0?0:a,a=a>=l.value?l.value:a;var r=a>t.value?A:R;Array.from({length:Math.abs(a-t.value)}).forEach(r)}},ne={size:n,vertical:d};return z(ne),we(()=>l.value,Ce(function*(){yield ce(),Z(),P()})),Te(()=>{window.addEventListener("resize",P)}),Ie(()=>{window.removeEventListener("resize",P),D()}),{n:Ne,classes:Me,length:l,index:t,swipeEl:i,trackSize:s,translate:u,lockDuration:o,handleTouchstart:x,handleTouchmove:ee,handleTouchend:ae,next:A,prev:R,to:re,resize:P,toNumber:L}}});$.install=function(e){e.component($.name,$)};function Be(){var{bindParent:e,parentProvider:i}=he(j),{index:n}=me(q);if(!e||!i||!n)throw Error("<var-swipe-item/> must in <var-swipe/>");return{index:n,swipe:i,bindSwipe:e}}var{n:De}=G("swipe-item");function Ae(e,i){return I(),S("div",{class:g(e.n()),style:F({width:e.vertical?void 0:e.size+"px",height:e.vertical?e.size+"px":void 0,transform:"translate"+(e.vertical?"Y":"X")+"("+e.translate+"px)"})},[V(e.$slots,"default")],6)}const K=H({render:Ae,name:"VarSwipeItem",setup(){var e=p(0),{swipe:i,bindSwipe:n,index:d}=Be(),{size:s,vertical:u}=i,o=f=>{e.value=f},t={index:d,setTranslate:o};return n(t),{n:De,size:s,vertical:u,translate:e}}});K.install=function(e){e.component(K.name,K)};export{$ as S,K as a,Pe as p};
