import{d as de,a as U,r as me,b as y,w as J,o as fe,p as ce,f as B,h as W,M as m,N as v,R as k,F as be,ak as he,aj as K,O as ge,Q as Ve,q as Se,n as ye}from"./vue-router.esm-bundler.d85fe05e.js";import{a as M,u as ke,l as u,g as d,j as E,e as F,x as Fe,c as Ne,R as Te}from"./shared.33d42a23.js";import{F as Ce,u as ze}from"./provide.deebc008.js";function Pe(e){return["always","normal","never"].includes(e)}var we={modelValue:{type:[Number,Array],default:0},step:{type:[Number,String],default:1},range:{type:Boolean,default:!1},labelVisible:{type:String,default:"normal",validator:Pe},activeColor:{type:String},trackColor:{type:String},thumbColor:{type:String},labelColor:{type:String},labelTextColor:{type:String},trackHeight:{type:[String,Number]},max:{type:[String,Number],default:100},min:{type:[String,Number],default:0},thumbSize:{type:[String,Number]},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},rules:{type:Array},onChange:M(),onStart:M(),onEnd:M(),"onUpdate:modelValue":M()},{n:Y,classes:Le}=Ne("slider"),t;(function(e){e.First="1",e.Second="2"})(t||(t={}));var Me=["onTouchstart","onTouchmove","onTouchend","onTouchcancel"];function pe(e,C){var g=ce("var-form-details");return B(),W("div",{class:v(e.n())},[m("div",{class:v(e.classes(e.n("block"),[e.isDisabled,e.n("--disabled")],[e.errorMessage,e.n("--error")])),ref:"sliderEl",onClick:C[0]||(C[0]=function(){return e.click&&e.click(...arguments)})},[m("div",{class:v(e.n("track"))},[m("div",{class:v(e.n("track-background")),style:k({background:e.trackColor,height:e.multiplySizeUnit(e.trackHeight)})},null,6),m("div",{class:v(e.n("track-fill")),style:k(e.getFillStyle)},null,6)],2),(B(!0),W(be,null,he(e.thumbList,i=>(B(),W("div",{class:v(e.n("thumb")),key:i.enumValue,style:k({left:i.value+"%",zIndex:e.thumbsProps[i.enumValue].active?1:void 0}),onTouchstart:K(f=>e.start(f,i.enumValue),["stop"]),onTouchmove:K(f=>e.move(f,i.enumValue),["stop"]),onTouchend:f=>e.end(i.enumValue),onTouchcancel:f=>e.end(i.enumValue)},[ge(e.$slots,"button",{currentValue:i.text},()=>[m("div",{class:v(e.n("thumb-block")),style:k({background:e.thumbColor})},null,6),m("div",{class:v(e.classes(e.n("thumb-ripple"),[e.thumbsProps[i.enumValue].active,e.n("thumb-ripple--active")])),style:k({background:e.thumbColor})},null,6),m("div",{class:v(e.classes(e.n("thumb-label"),[e.showLabel(i.enumValue),e.n("thumb-label--active")])),style:k({background:e.labelColor,color:e.labelTextColor,height:e.thumbSize===void 0?e.thumbSize:e.multiplySizeUnit(e.thumbSize,2),width:e.thumbSize===void 0?e.thumbSize:e.multiplySizeUnit(e.thumbSize,2)})},[m("span",null,Ve(i.text),1)],6)])],46,Me))),128))],2),Se(g,{"error-message":e.errorMessage,class:v(e.n("form")),"var-slider-cover":""},null,8,["error-message","class"])],2)}const A=de({render:pe,name:"VarSlider",components:{VarFormDetails:Ce},props:we,setup(e){var{bindForm:C,form:g}=ze(),{errorMessage:i,validateWithTrigger:f,validate:Z,resetValidation:I}=ke(),x=()=>Z(e.rules,e.modelValue),R=()=>({startPosition:0,currentLeft:0,active:!1,percentValue:0}),_=()=>ye(()=>f(["onChange"],"onChange",e.rules,e.modelValue)),p=U(null),c=U(0),z=U(!1),n=me({[t.First]:R(),[t.Second]:R()}),D=y(()=>u(e.max)-u(e.min)),b=y(()=>c.value/D.value*u(e.step)),ee=y(()=>{var{modelValue:a,range:r}=e,l=[];return r&&d(a)?l=[{value:V(a[0]),enumValue:t.First,text:T(a[0])},{value:V(a[1]),enumValue:t.Second,text:T(a[1])}]:E(a)&&(l=[{value:V(a),enumValue:t.First,text:T(a)}]),l}),ae=y(()=>{var{activeColor:a,range:r,modelValue:l}=e,s=r&&d(l)?V(Math.min(l[0],l[1])):0,o=r&&d(l)?V(Math.max(l[0],l[1]))-s:V(l);return{width:o+"%",left:s+"%",background:a}}),N=y(()=>e.disabled||(g==null?void 0:g.disabled.value)),P=y(()=>e.readonly||(g==null?void 0:g.readonly.value)),re=a=>e.labelVisible==="always"?!0:e.labelVisible==="never"?!1:n[a].active,V=a=>{var{min:r,max:l}=e;return a<u(r)?0:a>u(l)?100:(a-u(r))/D.value*100},T=a=>{if(!E(a))return 0;var r=a;r<Number(e.min)&&(r=Number(e.min)),r>Number(e.max)&&(r=Number(e.max));var l=parseInt(""+r,10)===r;return l?r:u(r.toPrecision(5))},X=(a,r)=>{var l=[],{step:s,range:o,modelValue:h,onChange:w,min:S}=e,O=u(s),Q=Math.round(a/b.value),L=Q*O+u(S),oe=n[r].percentValue*O+u(S);if(n[r].percentValue=Q,o&&d(h)&&(l=r===t.First?[L,h[1]]:[h[0],L]),oe!==L){var G=o?l.map(ve=>T(ve)):T(L);F(w,G),F(e["onUpdate:modelValue"],G),_()}},le=a=>{if(!e.range)return t.First;var r=n[t.First].percentValue*b.value,l=n[t.Second].percentValue*b.value,s=Math.abs(a-r),o=Math.abs(a-l);return s<=o?t.First:t.Second},te=(a,r)=>{c.value||(c.value=p.value.offsetWidth),!(N.value||P.value)&&(F(e.onStart),z.value=!0,n[r].startPosition=a.touches[0].clientX)},ne=(a,r)=>{if(!(N.value||P.value||!z.value)){var l=a.touches[0].clientX-n[r].startPosition+n[r].currentLeft;n[r].active=!0,l<=0?l=0:l>=c.value&&(l=c.value),X(l,r)}},$=a=>{var{range:r,modelValue:l,onEnd:s,step:o,min:h}=e;if(!(N.value||P.value)){var w=[];n[a].currentLeft=n[a].percentValue*b.value,n[a].active=!1;var S=n[a].percentValue*u(o)+u(h);r&&d(l)&&(w=a===t.First?[S,l[1]]:[l[0],S]),F(s,r?w:S),z.value=!1}},ue=a=>{if(!(N.value||P.value)&&!a.target.closest("."+Y("thumb"))){var r=a.clientX-Te(a.currentTarget),l=le(r);X(r,l),$(l)}},j=()=>{var a=u(e.step);return isNaN(a)?(console.warn('[Varlet] Slider: type of prop "step" should be Number'),!1):a<0?(console.warn('[Varlet] Slider: "step" should be > 0'),!1):!0},H=()=>{var{range:a,modelValue:r}=e;return a&&!d(r)?(console.error('[Varlet] Slider: "modelValue" should be an Array'),!1):!a&&d(r)?(console.error('[Varlet] Slider: "modelValue" should be a Number'),!1):a&&d(r)&&r.length<2?(console.error('[Varlet] Slider: "modelValue" should have two value'),!1):!0},q=function(a,r){a===void 0&&(a=e.modelValue),r===void 0&&(r=u(e.step));var l=s=>{var{min:o,max:h}=e;return s<u(o)?0:s>u(h)?D.value/r:(s-u(o))/r};e.range&&d(a)?(n[t.First].percentValue=l(a[0]),n[t.First].currentLeft=n[t.First].percentValue*b.value,n[t.Second].percentValue=l(a[1]),n[t.Second].currentLeft=n[t.Second].percentValue*b.value):E(a)&&(n[t.First].currentLeft=l(a)*b.value)},ie=()=>{var a=e.range?[0,0]:0;F(e["onUpdate:modelValue"],a),I()},se={reset:ie,validate:x,resetValidation:I};return F(C,se),J([()=>e.modelValue,()=>e.step],a=>{var[r,l]=a;!j()||!H()||z.value||q(r,u(l))}),J(c,()=>q()),fe(()=>{!j()||!H()||(c.value=p.value.offsetWidth)}),{n:Y,classes:Le,Thumbs:t,sliderEl:p,getFillStyle:ae,isDisabled:N,errorMessage:i,thumbsProps:n,thumbList:ee,multiplySizeUnit:Fe,toNumber:u,showLabel:re,start:te,move:ne,end:$,click:ue}}});A.install=function(e){e.component(A.name,A)};export{A as S};
