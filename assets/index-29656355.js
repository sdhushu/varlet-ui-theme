import{a as se,D as oe,k as $,c as q,e as z,A as de,U as fe,F as ce,u as he}from"./shared-128c81f0.js";import{d as H,a as p,b as me,w as pe,v as we,x as Te,u as ge,f as S,h as I,M as Se,O as V,N as b,R,F as Ie,ai as be,j as ye}from"./vue-router.esm-bundler-fa266481.js";import{u as Ee}from"./useChildren-57fd1ce4.js";var O=Symbol("SWIPE_BIND_SWIPE_ITEM_KEY");function ke(){var{childProviders:e,length:v,bindChildren:t}=Ee(O);return{length:v,swipeItems:e,bindSwipeItems:t}}var Pe={loop:{type:Boolean,default:!0},autoplay:{type:[String,Number]},duration:{type:[String,Number],default:300},initialIndex:{type:[String,Number],default:0},indicator:{type:Boolean,default:!0},indicatorColor:{type:String},vertical:{type:Boolean,default:!1},touchable:{type:Boolean,default:!0},onChange:se()};function U(e,v,t,f,s,u,d){try{var n=e[u](d),c=n.value}catch(N){t(N);return}n.done?v(c):Promise.resolve(c).then(f,s)}function Ce(e){return function(){var v=this,t=arguments;return new Promise(function(f,s){var u=e.apply(v,t);function d(c){U(u,f,s,d,n,"next",c)}function n(c){U(u,f,s,d,n,"throw",c)}d(void 0)})}}var ze=250,Ne=20,{n:De,classes:Be}=q("swipe"),Ye=["onClick"];function Me(e,v){return S(),I("div",{class:b(e.n()),ref:"swipeEl"},[Se("div",{class:b(e.classes(e.n("track"),[e.vertical,e.n("--vertical")])),style:R({width:e.vertical?void 0:e.trackSize+"px",height:e.vertical?e.trackSize+"px":void 0,transform:"translate"+(e.vertical?"Y":"X")+"("+e.translate+"px)",transitionDuration:e.lockDuration?"0ms":e.toNumber(e.duration)+"ms"}),onTouchstart:v[0]||(v[0]=function(){return e.handleTouchstart&&e.handleTouchstart(...arguments)}),onTouchmove:v[1]||(v[1]=function(){return e.handleTouchmove&&e.handleTouchmove(...arguments)}),onTouchend:v[2]||(v[2]=function(){return e.handleTouchend&&e.handleTouchend(...arguments)})},[V(e.$slots,"default")],38),V(e.$slots,"indicator",{index:e.index,length:e.length},()=>[e.indicator&&e.length?(S(),I("div",{key:0,class:b(e.classes(e.n("indicators"),[e.vertical,e.n("--indicators-vertical")]))},[(S(!0),I(Ie,null,be(e.length,(t,f)=>(S(),I("div",{class:b(e.classes(e.n("indicator"),[e.index===f,e.n("--indicator-active")],[e.vertical,e.n("--indicator-vertical")])),style:R({background:e.indicatorColor}),key:t,onClick:s=>e.to(f)},null,14,Ye))),128))],2)):ye("v-if",!0)])],2)}var j=H({name:"VarSwipe",props:Pe,setup(e){var v=p(null),t=p(0),f=me(()=>e.vertical),s=p(0),u=p(0),d=p(!1),n=p(0),{swipeItems:c,bindSwipeItems:N,length:l}=ke(),y=!1,D=-1,E,k,G,w,T,h=a=>c.find(r=>{var{index:i}=r;return i.value===a}),Q=()=>{e.loop&&(u.value>=0&&h(l.value-1).setTranslate(-s.value),u.value<=-(s.value-t.value)&&h(0).setTranslate(s.value),u.value>-(s.value-t.value)&&u.value<0&&(h(l.value-1).setTranslate(0),h(0).setTranslate(0)))},B=a=>{var r=de(a)?a:Math.floor((u.value-t.value/2)/-t.value),{loop:i}=e;return r<=-1?i?-1:0:r>=l.value?i?l.value:l.value-1:r},Z=a=>{var{loop:r}=e;return a===-1?r?l.value-1:0:a===l.value?r?0:l.value-1:a},Y=a=>{var{loop:r}=e;return a<0?r?l.value-1:0:a>l.value-1?r?0:l.value-1:a},M=a=>{var r=u.value>=t.value,i=u.value<=-s.value,o=0,m=-(s.value-t.value);d.value=!0,(r||i)&&(d.value=!0,u.value=i?o:m,h(0).setTranslate(0),h(l.value-1).setTranslate(0)),fe(()=>{d.value=!1,z(a)})},_=()=>{n.value=Y($(e.initialIndex))},A=()=>{var{autoplay:a}=e;!a||l.value<=1||(P(),D=window.setTimeout(()=>{W(),A()},$(a)))},P=()=>{D&&clearTimeout(D)},x=(a,r)=>{if(a>r&&a>10)return"horizontal";if(r>a&&r>10)return"vertical"},ee=a=>{if(!(l.value<=1||!e.touchable)){var{clientX:r,clientY:i}=a.touches[0];E=r,k=i,G=performance.now(),y=!0,P(),M(()=>{d.value=!0})}},ae=a=>{var{touchable:r,vertical:i}=e;if(!(!y||!r)){var{clientX:o,clientY:m}=a.touches[0],g=Math.abs(o-E),X=Math.abs(m-k),le=x(g,X),ue=i?"vertical":"horizontal";if(le===ue){a.preventDefault();var ve=w!==void 0?o-w:0,ie=T!==void 0?m-T:0;w=o,T=m,u.value+=i?ie:ve,Q()}}},re=()=>{if(y){var{vertical:a,onChange:r}=e,i=a?T<k:w<E,o=Math.abs(a?k-T:E-w),m=performance.now()-G<=ze&&o>=Ne,g=m?B(i?n.value+1:n.value-1):B();y=!1,d.value=!1,w=void 0,T=void 0,u.value=g*-t.value;var X=n.value;n.value=Z(g),A(),X!==n.value&&z(r,n.value)}},C=()=>{v.value&&(d.value=!0,t.value=e.vertical?v.value.offsetHeight:v.value.offsetWidth,s.value=t.value*l.value,u.value=n.value*-t.value,c.forEach(a=>{a.setTranslate(0)}),A(),setTimeout(()=>{d.value=!1}))},W=a=>{if(!(l.value<=1)){var{loop:r,onChange:i}=e,o=n.value;n.value=Y(o+1),(a==null?void 0:a.event)!==!1&&z(i,n.value),M(()=>{if(o===l.value-1&&r){h(0).setTranslate(s.value),u.value=l.value*-t.value;return}o!==l.value-1&&(u.value=n.value*-t.value)})}},K=a=>{if(!(l.value<=1)){var{loop:r,onChange:i}=e,o=n.value;n.value=Y(o-1),(a==null?void 0:a.event)!==!1&&z(i,n.value),M(()=>{if(o===0&&r){h(l.value-1).setTranslate(-s.value),u.value=t.value;return}o!==0&&(u.value=n.value*-t.value)})}},ne=(a,r)=>{if(!(l.value<=1||a===n.value)){a=a<0?0:a,a=a>=l.value?l.value:a;var i=a>n.value?W:K,o=Math.abs(a-n.value);Array.from({length:o}).forEach((m,g)=>{i({event:g===o-1?r==null?void 0:r.event:!1})})}},te={size:t,vertical:f};return N(te),pe(()=>l.value,Ce(function*(){yield ce(),_(),C()})),we(C),Te(P),ge(P),oe(window,"resize",C),{n:De,classes:Be,length:l,index:n,swipeEl:v,trackSize:s,translate:u,lockDuration:d,handleTouchstart:ee,handleTouchmove:ae,handleTouchend:re,next:W,prev:K,to:ne,resize:C,toNumber:$}}});j.render=Me;const L=j;L.install=function(e){e.component(L.name,L)};function Ae(){var{bindParent:e,index:v,parentProvider:t}=he(O);if(!e)throw Error("<var-swipe-item/> must in <var-swipe/>");return{index:v,swipe:t,bindSwipe:e}}var{n:We}=q("swipe-item");function Xe(e,v){return S(),I("div",{class:b(e.n()),style:R({width:e.vertical?void 0:e.size+"px",height:e.vertical?e.size+"px":void 0,transform:"translate"+(e.vertical?"Y":"X")+"("+e.translate+"px)"})},[V(e.$slots,"default")],6)}var J=H({name:"VarSwipeItem",setup(){var e=p(0),{swipe:v,bindSwipe:t,index:f}=Ae(),{size:s,vertical:u}=v,d=c=>{e.value=c},n={index:f,setTranslate:d};return t(n),{n:We,size:s,vertical:u,translate:e}}});J.render=Xe;const F=J;F.install=function(e){e.component(F.name,F)};export{L as S,F as a,Pe as p};
