import{w as ve,i as oe,c as G,b as k,z as se,l as de,h as fe,x as ce}from"./shared.dccb68a6.js";import{d as q,a as p,b as he,w as me,o as pe,u as we,Z as $,f as I,h as S,M as Te,O as K,N as g,R as V,F as Ie,ak as Se,j as ge,X as Ee}from"./vue-router.esm-bundler.ad5bb508.js";var H=Symbol("SWIPE_BIND_SWIPE_ITEM_KEY"),Z=Symbol("SWIPE_COUNT_SWIPE_ITEM_KEY");function be(){var{childProviders:e,bindChildren:i}=oe(H),{length:n}=ve(Z);return{length:n,swipeItems:e,bindSwipeItems:i}}var ye={loop:{type:Boolean,default:!0},autoplay:{type:[String,Number]},duration:{type:[String,Number],default:300},initialIndex:{type:[String,Number],default:0},indicator:{type:Boolean,default:!0},indicatorColor:{type:String},vertical:{type:Boolean,default:!1},touchable:{type:Boolean,default:!0},onChange:{type:Function}};function U(e,i,n,d,o,u,s){try{var t=e[u](s),f=t.value}catch(z){n(z);return}t.done?i(f):Promise.resolve(f).then(d,o)}function Pe(e){return function(){var i=this,n=arguments;return new Promise(function(d,o){var u=e.apply(i,n);function s(f){U(u,d,o,s,t,"next",f)}function t(f){U(u,d,o,s,t,"throw",f)}s(void 0)})}}var Ce=250,ke=20,{n:ze,classes:Ne}=G("swipe"),Me=["onClick"];function Ye(e,i){return I(),S("div",{class:g(e.n()),ref:"swipeEl"},[Te("div",{class:g(e.classes(e.n("track"),[e.vertical,e.n("--vertical")])),style:V({width:e.vertical?void 0:e.trackSize+"px",height:e.vertical?e.trackSize+"px":void 0,transform:"translate"+(e.vertical?"Y":"X")+"("+e.translate+"px)",transitionDuration:e.lockDuration?"0ms":e.toNumber(e.duration)+"ms"}),onTouchstart:i[0]||(i[0]=function(){return e.handleTouchstart&&e.handleTouchstart(...arguments)}),onTouchmove:i[1]||(i[1]=function(){return e.handleTouchmove&&e.handleTouchmove(...arguments)}),onTouchend:i[2]||(i[2]=function(){return e.handleTouchend&&e.handleTouchend(...arguments)})},[K(e.$slots,"default")],38),K(e.$slots,"indicator",{index:e.index,length:e.length},()=>[e.indicator&&e.length?(I(),S("div",{key:0,class:g(e.classes(e.n("indicators"),[e.vertical,e.n("--indicators-vertical")]))},[(I(!0),S(Ie,null,Se(e.length,(n,d)=>(I(),S("div",{class:g(e.classes(e.n("indicator"),[e.index===d,e.n("--indicator-active")],[e.vertical,e.n("--indicator-vertical")])),style:V({background:e.indicatorColor}),key:n,onClick:o=>e.to(d)},null,14,Me))),128))],2)):ge("v-if",!0)])],2)}const L=q({render:Ye,name:"VarSwipe",props:ye,setup(e){var i=p(null),n=p(0),d=he(()=>e.vertical),o=p(0),u=p(0),s=p(!1),t=p(0),{swipeItems:f,bindSwipeItems:z,length:l}=be(),E=!1,N=-1,b,y,O,w,T,c=a=>f.find(r=>{var{index:v}=r;return v.value===a}),j=()=>{!e.loop||(u.value>=0&&c(l.value-1).setTranslate(-o.value),u.value<=-(o.value-n.value)&&c(0).setTranslate(o.value),u.value>-(o.value-n.value)&&u.value<0&&(c(l.value-1).setTranslate(0),c(0).setTranslate(0)))},M=a=>{var r=Ee(a)?a:Math.floor((u.value-n.value/2)/-n.value),{loop:v}=e;return r<=-1?v?-1:0:r>=l.value?v?l.value:l.value-1:r},J=a=>{var{loop:r}=e;return a===-1?r?l.value-1:0:a===l.value?r?0:l.value-1:a},Y=a=>{var{loop:r}=e;return a<0?r?l.value-1:0:a>l.value-1?r?0:l.value-1:a},W=a=>{var r=u.value>=n.value,v=u.value<=-o.value,h=0,m=-(o.value-n.value);s.value=!0,(r||v)&&(s.value=!0,u.value=v?h:m,c(0).setTranslate(0),c(l.value-1).setTranslate(0)),se(()=>{s.value=!1,k(a)})},Q=()=>{t.value=Y($(e.initialIndex))},B=()=>{var{autoplay:a}=e;!a||l.value<=1||(D(),N=window.setTimeout(()=>{X(),B()},$(a)))},D=()=>{N&&clearTimeout(N)},_=(a,r)=>{if(a>r&&a>10)return"horizontal";if(r>a&&r>10)return"vertical"},x=a=>{if(!(l.value<=1||!e.touchable)){var{clientX:r,clientY:v}=a.touches[0];b=r,y=v,O=performance.now(),E=!0,D(),W(()=>{s.value=!0})}},ee=a=>{var{touchable:r,vertical:v}=e;if(!(!E||!r)){var{clientX:h,clientY:m}=a.touches[0],C=Math.abs(h-b),A=Math.abs(m-y),te=_(C,A),le=v?"vertical":"horizontal";if(te===le){a.preventDefault();var ue=w!==void 0?h-w:0,ie=T!==void 0?m-T:0;w=h,T=m,u.value+=v?ie:ue,j()}}},ae=()=>{if(!!E){var{vertical:a,onChange:r}=e,v=a?T<y:w<b,h=Math.abs(a?y-T:b-w),m=performance.now()-O<=Ce&&h>=ke,C=m?M(v?t.value+1:t.value-1):M();E=!1,s.value=!1,w=void 0,T=void 0,u.value=C*-n.value;var A=t.value;t.value=J(C),B(),A!==t.value&&k(r,t.value)}},P=()=>{s.value=!0,n.value=e.vertical?i.value.offsetHeight:i.value.offsetWidth,o.value=n.value*l.value,u.value=t.value*-n.value,f.forEach(a=>{a.setTranslate(0)}),B(),setTimeout(()=>{s.value=!1})},X=()=>{if(!(l.value<=1)){var{loop:a,onChange:r}=e,v=t.value;t.value=Y(v+1),k(r,t.value),W(()=>{if(v===l.value-1&&a){c(0).setTranslate(o.value),u.value=l.value*-n.value;return}v!==l.value-1&&(u.value=t.value*-n.value)})}},R=()=>{if(!(l.value<=1)){var{loop:a,onChange:r}=e,v=t.value;t.value=Y(v-1),k(r,t.value),W(()=>{if(v===0&&a){c(l.value-1).setTranslate(-o.value),u.value=n.value;return}v!==0&&(u.value=t.value*-n.value)})}},re=a=>{if(!(l.value<=1||a===t.value)){a=a<0?0:a,a=a>=l.value?l.value:a;var r=a>t.value?X:R;Array.from({length:Math.abs(a-t.value)}).forEach(r)}},ne={size:n,vertical:d};return z(ne),me(()=>l.value,Pe(function*(){yield de(),Q(),P()})),pe(()=>{window.addEventListener("resize",P)}),we(()=>{window.removeEventListener("resize",P),D()}),{n:ze,classes:Ne,length:l,index:t,swipeEl:i,trackSize:o,translate:u,lockDuration:s,handleTouchstart:x,handleTouchmove:ee,handleTouchend:ae,next:X,prev:R,to:re,resize:P,toNumber:$}}});L.install=function(e){e.component(L.name,L)};function We(){var{bindParent:e,parentProvider:i}=fe(H),{index:n}=ce(Z);if(!e||!i||!n)throw Error("<var-swipe-item/> must in <var-swipe/>");return{index:n,swipe:i,bindSwipe:e}}var{n:Be}=G("swipe-item");function De(e,i){return I(),S("div",{class:g(e.n()),style:V({width:e.vertical?void 0:e.size+"px",height:e.vertical?e.size+"px":void 0,transform:"translate"+(e.vertical?"Y":"X")+"("+e.translate+"px)"})},[K(e.$slots,"default")],6)}const F=q({render:De,name:"VarSwipeItem",setup(){var e=p(0),{swipe:i,bindSwipe:n,index:d}=We(),{size:o,vertical:u}=i,s=f=>{e.value=f},t={index:d,setTranslate:s};return n(t),{n:Be,size:o,vertical:u,translate:e}}});F.install=function(e){e.component(F.name,F)};export{L as S,F as a,ye as p};
